# WebBeds Price Tracker - Project TODO

## Phase 1: Database Schema & Core Setup
- [x] تصميم جداول قاعدة البيانات (hotels, prices, credentials, sync_logs)
- [x] إنشاء migrations لقاعدة البيانات
- [x] إعداد اتصال قاعدة البيانات

## Phase 2: Web Scraping Module (Puppeteer)
- [x] تثبيت Puppeteer وإعداد المتصفح
- [x] تطوير وحدة تسجيل الدخول (Login Module)
- [x] حفظ واستعادة جلسة المتصفح من ملف JSON
- [x] تطوير وحدة البحث عن الأسعار (Search Module)
- [x] معالجة استخراج السعر من صفحة النتائج
- [x] تطبيق معادلة خصم 4.998% على الأسعار
- [ ] معالجة الأخطاء والإعادة التلقائية (Retry Logic)

## Phase 3: Backend API & Database
- [x] إنشاء tRPC procedures للبحث عن الأسعار
- [x] إنشاء tRPC procedures لجلب البيانات التاريخية
- [x] إنشاء tRPC procedures لإدارة بيانات الاعتماد (CRUD)
- [x] تطوير وحدة معالجة البيانات (Data Processing)
- [ ] إنشاء endpoints للتحديث اليدوي والتلقائي

## Phase 4: Scheduled Tasks (node-cron)
- [x] إعداد جدولة المهام (Cron Jobs)
- [x] تطوير وحدة التحديث التلقائي (Auto-Update)
- [ ] إضافة logging لعمليات التحديث
- [ ] معالجة الأخطاء والإعادة التلقائية

## Phase 5: Frontend Dashboard
- [x] تصميم تخطيط الداشبورد (Dashboard Layout)
- [x] إنشاء جدول الأسعار الرئيسي (Price Table)
- [x] تطوير ميزة مقارنة الأسعار (Price Comparison)
- [x] إضافة مؤشرات التحميل والتحديث (Loading Indicators)
- [x] عرض آخر وقت تحديث (Last Update Time)
- [x] إضافة نموذج إدارة بيانات الاعتماد (Credentials Form)

## Phase 6: Security & Credentials Management
- [x] تشفير بيانات الاعتماد في قاعدة البيانات
- [x] إنشاء نموذج إدخال بيانات الاعتماد

## Phase 7: Testing
- [x] كتابة اختبارات vitest لوحدة إدارة الجلسات
- [x] كتابة اختبارات vitest لوحدة مراقبة المزامنة
- [x] تشغيل والتحقق من نجاح جميع الاختبارات (31 اختبار ناجح)
- [ ] التحقق من صحة بيانات الاعتماد قبل الحفظ
- [ ] إضافة آلية حذف بيانات الاعتماد

## Phase 7: Testing & Optimization
- [ ] اختبار وحدة تسجيل الدخول
- [ ] اختبار وحدة البحث عن الأسعار
- [ ] اختبار جدولة المهام التلقائية
- [ ] اختبار واجهة المستخدم (UI Tests)
- [ ] اختبار الأداء والاستقرار

## Phase 8: Deployment Configuration
- [ ] إنشاء ملف .gitignore
- [ ] إنشاء ملف README.md شامل
- [ ] إعداد ملف railway.json لنشر على Railway
- [ ] إعداد متغيرات البيئة (Environment Variables)
- [ ] اختبار النشر على بيئة الإنتاج

## Phase 9: Final Delivery
- [ ] مراجعة نهائية للكود
- [ ] توثيق شاملة للمشروع
- [ ] إنشاء checkpoint نهائي
- [ ] تسليم المشروع للمستخدم


## Bug Fixes & Issues
- [x] إصلاح الصفحة الرئيسية (Home.tsx) - تعرض صفحة Example بدلاً من الداشبورد
- [x] التحقق من تحميل مكونات الداشبورد بشكل صحيح
- [x] إصلاح مشاكل التوافقية مع المتصفح
- [x] التحقق من الاتصال بـ tRPC endpoints
- [x] اختبار نماذج إدخال البيانات
- [x] التحقق من عرض الأخطاء والتنبيهات

## New Features - Session Management & Monitoring
- [x] إضافة نموذج رفع جلسة JSON محفوظة
- [x] إضافة خيار إدخال رمز التحقق (2FA)
- [x] عرض عداد دورات السحب التلقائية
- [x] عرض وقت آخر تحديث بالتفاصيل
- [x] إضافة زر تحميل الجلسة الحالية كـ JSON


## Phase 8: Price Management & Alerts System
- [x] إضافة جدول أسعار المستخدم الخاصة (userPrices) في قاعدة البيانات
- [x] إنشاء واجهة لإدخال/تحديث أسعار المستخدم لكل فندق وتاريخ
- [x] إضافة عمود لعرض سعر المستخدم الأساسي بدون النسبة
- [x] إضافة عمود لعرض سعر المنافس الأساسي بدون النسبة
- [x] إضافة عمود للفرق بين السعرين مع تلوين (أحمر للخسارة، أخضر للربح)
- [x] إنشاء نظام التنبيهات الذكية (عندما يكون سعر المنافس أقل)
- [x] إضافة جدول تنبيهات (alerts) لتسجيل التنبيهات التاريخية
- [x] عرض التنبيهات النشطة في الواجهة مع إمكانية الإجراء السريع
- [x] إضافة tRPC procedures لإدارة الأسعار الخاصة
- [x] إضافة tRPC procedures لجلب التنبيهات
- [x] تحديث الداشبورد لعرض المقارنة الفورية
- [ ] كتابة اختبارات vitest لنظام التنبيهات
